<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css">
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    <script src="hta_ca.js"></script>
    <script src="ca_tract_school_district.js"></script>

    <style>
      #map {   height: 500px;  width: 700px;}
    </style>

</head>

<body>

    <div id="map"></div>

    <script>

      var school   = L.tileLayer(
        //mapboxUrl, {id: 'MapID', attribution: mapboxAttribution
        'https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                      attribution: 'Map data copywright <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                      '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                      'Imagery copywright <a href="http://mapbox.com">Mapbox</a',
                      id: 'examples.map-20v6611k'});
      var District = L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                    attribution: 'Map data copywright <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery copywright <a href="http://mapbox.com">Mapbox</a',
                    id: 'examples.map-20v6611k'
                  });
      var map = L.map('map',{
          layers:[school, District]}).setView([47,-100], 3);
      var baseMaps = {
        "District":District,
        "School":school
          };
      var overlayMaps = {

          };

     L.control.layers(baseMaps, overlayMaps).addTo(map);
      //District.addTo(map);
      //adding color to the map chloropleth
      function getColor(d) {
          return d > 20 ? '#800026' :
                 d > 16  ? '#BD0026' :
                 d > 13  ? '#E31A1C' :
                 d > 9  ? '#FC4E2A' :
                 d > 7   ? '#FD8D3C' :
                 d > 5   ? '#FEB24C' :
                 d > 2   ? '#FED976' :
                            '#FFEDA0';
      }
      function style(feature) {
          return {
              fillColor: getColor(feature.properties.co2_per_acre_local),
              weight: 2,
              opacity: 1,
              color: 'white',
              dashArray: '3',
              fillOpacity: 0.7
          };
      }
      //adds chloropleth to map

//TO IMPLEMENT (notes):
      //if somelayer is selected, set dataset to whatever the array is called, e.g.
      // if education is selected on map, use dataset = secondary_school_district

console.log($('.leaflet-control-layers-selector:checked')== District);
console.log($('.leaflet-control-layers-selector:checked'));
if ( (eventLayer.name === 'District')) {


      L.geoJson(calidata, {style: style}).addTo(map);
      var geojson;
      //highlight/remove highlight/zoom features
      function highlightFeature(e) {
          var layer = e.target;
          layer.setStyle({
              weight: 5,
              color: '#666',
              dashArray: '',
              fillOpacity: 0.7
          });
          if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
              layer.bringToFront();
          }
      }
      function resetHighlight(e) {
          geojson.resetStyle(e.target);
      }
      function zoomToFeature(e) {
          map.fitBounds(e.target.getBounds());
          console.log($('.leaflet-control-layers-selector:checked'));
      }
      //implements cool features
      function onEachFeature(feature, layer) {
        layer.on({
          mouseover: highlightFeature,
          mouseout: resetHighlight,
          click: zoomToFeature

        });
      }
      geojson = L.geoJson(calidata, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);
    }
    </script>

</body>

</html>
